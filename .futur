import numpy as np

class avlayer:
    def __init__(self, nb, func):
        self.func = func
        self.biais = np.ones((1, nb))
        self.poids = np.ones((nb, nb))  # simplification : poids carr√©
        self.kwargs = np.ones((1, nb))

    def forward(self, x):
        z = x @ self.poids + self.biais + self.kwargs
        return self.func(z)

    def __repr__(self):
        return f"Layer(biais={self.biais.shape}, poids={self.poids.shape}, kwargs={self.kwargs.shape})"

# Exemple d'utilisation :
layer = avlayer(nb=3, func=np.tanh)
x = np.array([[0.5, 0.2, 0.1]])
out = layer.forward(x)
print("Sortie :", out)
